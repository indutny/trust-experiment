#!/usr/bin/env node
'use strict';

const Graph = require('../');
const split = require('split');

const ROOT = process.argv[2] | 0;
console.log('root is %d', ROOT);

const g = new Graph(ROOT);

process.stdin.pipe(split()).on('data', (line) => {
  const match = line.match(/^\s*(\d+)\s*(\d+)\s*$/);
  if (!match)
    return;

  const user = match[1] | 0;
  const follower = match[2] | 0;

  g.link(follower, user);
}).on('end', () => {
  const counts = new Array(5).fill(0);
  g.child.forEach((value) => {
    counts[value.depth]++;
  });
  console.log('Graph child count:', counts);
});
